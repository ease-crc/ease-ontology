rl_write_history :-
      expand_file_name("~/.pl-history", [File|_]),
      rl_write_history(File).

  :- (
      current_prolog_flag(readline, true)
     ->
      expand_file_name("~/.pl-history", [File|_]),
      (exists_file(File) -> rl_read_history(File); true),
      at_halt(rl_write_history)
     ;
      true
     ).
